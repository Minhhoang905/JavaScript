<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASM2</title>
    <!-- css -->
    <link rel="stylesheet" href="styles.css">
    <!-- bootstrap css -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>

<body>
    <div class="container">
        <!-- Tạo text và các textfield để input thông tin -->
        <!-- Tên -->
        <p>Tên: </p><input type="text" id="name">
        <!-- Ngày sinh -->
        <p>DOB (ngày sinh): </p> <input type="text" id="dayOfBirth">
        <!-- Điểm toán -->
        <p>Điểm toán: </p> <input type="text" id="math">
        <!-- Điểm lý -->
        <p>Điểm lý: </p> <input type="text" id="physic">
        <!-- Điểm hóa -->
        <p>Điểm hóa: </p> <input class="mb-2" type="text" id="chemical">
        <!-- Tạo các button theo từng chức năng -->
        <br>
        <button id="input">Nhập</button>
        <button id="calculate-average">Tính điểm trung bình</button>
        <button id="determine-rank">Xác định học lực</button>
        <hr>

        <!-- Tạo table -->
        <table class="text-center">
            <!-- Tiêu đề -->
            <thead>
                <tr>
                    <th>Họ và tên</th>
                    <th>Ngày tháng năm sinh</th>
                    <th>Điểm toán</th>
                    <th>Điểm lý</th>
                    <th>Điểm hóa</th>
                    <th>Điểm trung bình</th>
                    <th>Học lực</th>
                </tr>
            </thead>
            <!-- Nội dung -->
            <tbody id="tbody">

            </tbody>
        </table>
    </div>
    <script>

        //Tạo biến index
        let index = 1;

        function addRow() {
            //Lấy element tbody nơi thêm các dòng mới 
            let tbody = document.getElementById("tbody");
            // Tạo 1 hàng mới trong table (tạo element tr)
            let tr1 = document.createElement("tr");

            // Lấy thông tin (String) ở input "name"
            let name = document.getElementById("name").value;
            // Lấy thông tin (String) ở input "dayOfBirth"
            let dayOfBirth = document.getElementById("dayOfBirth").value;
            // Lấy giá trị (value) ở input "math"
            let math = document.getElementById("math").value;
            // Lấy giá trị (value) ở input "physic"
            let physic = document.getElementById("physic").value;
            // Lấy giá trị (value) ở input "chemical"
            let chemical = document.getElementById("chemical").value;

            //Tạo function check điều kiện nhập điểm các môn học
            function isValidScore(score) {
                return score >= 0 && score <= 10.0;
            }

            // Kiểm tra tính hợp lệ của điểm toán
            if (!isValidScore(math)) {
                alert("Điểm toán phải là ký tự số, phải lớn hơn 0 và nhỏ hơn 10.");
                return;
            }
            // Kiểm tra tính hợp lệ của điểm lý
            if (!isValidScore(physic)) {
                alert("Điểm lý phải là ký tự số, phải lớn hơn 0 và nhỏ hơn 10.")
                return;
            }
            // Kiểm tra tính hợp lệ của điểm hóa
            if (!isValidScore(chemical)) {
                alert("Điểm Hóa phải là ký tự số, phải lớn hơn 0 và nhỏ hơn 10.")
                return;
            }

            //Thêm hàng mới vào tbody 
            tbody.append(tr1);

            //Tạo ID cho tr (nhằm lấy data từ HTML)
            tr1.id = index;

            // Tạo 1 ô (td) mới cho "tên"
            let tdName = document.createElement("td");
            // Thêm ô "tên" vào hàng mới (tr) trong bảng
            tr1.append(tdName);
            //Hiển thị giá trị từ input "tên" vào ô vừa mới tạo
            tdName.innerHTML = name;

            //Tạo 1 ô (td) mới cho "DOB"
            let tdDayOfBirth = document.createElement("td");
            //Thêm ô "DOB" vào hàng mới (tr) trong bảng
            tr1.append(tdDayOfBirth);
            //Hiển thị giá trị từ input "DOB" vào ô vừa mới tạo
            tdDayOfBirth.innerHTML = dayOfBirth;

            //Tạo 1 ô (td) mới cho "điểm toán"
            let tdMath = document.createElement("td");
            //Thêm ô "điểm toán" vào hàng mới (tr) trong bảng
            tr1.append(tdMath);
            //Hiển thị giá trị từ input "điểm toán" vào ô vừa mới tạo
            tdMath.innerHTML = math;
            //Tạo id cho điểm toán
            tdMath.id = "MathID" + index;

            //Tạo 1 ô (td) mới cho "điểm lý"
            let tdPhysics = document.createElement("td");
            //Thêm ô "điểm lý" vào hàng mới (tr) trong bảng
            tr1.append(tdPhysics);
            //Hiển thị giá trị từ input "điểm lý" vào ô vừa mới tạo
            tdPhysics.innerHTML = physic;
            //Tạo id cho điểm lý
            tdPhysics.id = "PhysicsID" + index;

            //Tạo 1 ô (td) mới cho "điểm hóa"
            let tdChemical = document.createElement("td");
            //Thêm ô "điểm hóa" vào hàng mới (tr) trong bảng
            tr1.append(tdChemical);
            //Hiển thị giá trị từ input "điểm hóa" vào ô vừa mới tạo
            tdChemical.innerHTML = chemical;
            //Tạo id cho điểm hóa
            tdChemical.id = "ChemicalID" + index;

            //Tạo 1 ô (td) mới cho "điểm trung bình"
            let tdAverage = document.createElement("td");
            //Thêm ô "điểm trung bình" vào hàng mới (tr) trong bảng
            tr1.append(tdAverage);
            //Tạo id cho điểm trung bình
            tdAverage.id = "AverageID" + index;

            //Tạo 1 ô (td) mới cho "học lực"
            let tdRank = document.createElement("td");
            //Thêm ô "học lực" vào hàng mới (tr) trong bảng
            tr1.append(tdRank);
            //Tạo id cho "học lực"
            tdRank.id = "RankID" + index;

            //Tăng giá trị id + 1
            index = index + 1;
        }

        //Chức năng tính điểm trung bình
        function Averange() {
            //Tạo vòng lặp với i = 1 (khởi điểm với index = 1)
            for (let i = 1; i < index; i++) {
                //Lấy element của điểm toán + i 
                let math = document.getElementById("MathID" + i);
                //Lấy element của điểm lý + i 
                let physics = document.getElementById("PhysicsID" + i);
                //Lấy element của điểm hóa + i 
                let chemical = document.getElementById("ChemicalID" + i);
                //Lấy element của điểm trung bình + i 
                let average = document.getElementById("AverageID" + i);

                //Tính điểm trung bình và gán vào table
                average.innerHTML = (math.innerHTML - (- physics.innerHTML) - (- chemical.innerHTML)) / 3;
            }

            // //Tạo vòng lặp với i = 1 (khởi điểm với index = 1)
            // for (let i = 1; i < index; i++) {
            //     //Lấy element của điểm toán + i, in ra (dạng String) rồi parseFloat
            //     let math = parseFloat(document.getElementById("MathID" + i).innerHTML);
            //     //Lấy element của điểm lý + i, in ra (dạng String) rồi parseFloat 
            //     let physics = parseFloat(document.getElementById("PhysicsID" + i).innerHTML);
            //     //Lấy element của điểm hóa + i, in ra (dạng String) rồi parseFloat 
            //     let chemical = parseFloat(document.getElementById("ChemicalID" + i).innerHTML);
            //     //Lấy element của điểm trung bình + i 
            //     let average = document.getElementById("AverageID" + i);

            //     //Tính điểm trung bình và gán vào table
            //     let avg = (math + physics + chemical) / 3;
            //     //In ra điểm trung bình vào element Id "AverageID"
            //     average.innerHTML = avg;
            // }
        }

        //Chức năng xác định và highlight học lực giỏi (>=8.0) 
        function highlightRank() {
            //Tạo vòng lặp 
            for (let i = 1; i < index; i++) {
                //In ra điểm trung bình từ các row, đồng thời parseFloat điểm trung bình
                let average = parseFloat(document.getElementById("AverageID" + i).innerHTML);
                //Lấy element id (i) của tr
                let tr = document.getElementById(i);
                //Lấy element của học lực + i 
                let tdRank = document.getElementById("RankID" + i);

                //Tạo if-else để xác định học lực
                if (average >= 8.0) {
                    //Dùng thuộc tính "classList" để ddd thêm class từ CSS vào hàng (tr)
                    tr.classList.add("highlight");
                    //In ra học lực vào id của ô (td) trong hàng (tr) đó
                    tdRank.innerHTML = "Giỏi";
                } else if (average >= 6.5 && average < 8.0) {
                    //In ra học lực vào id của ô (td) trong hàng (tr) đó
                    tdRank.innerHTML = "Khá";
                } else if (average >= 5.0 && average < 6.5) {
                    //In ra học lực vào id của ô (td) trong hàng (tr) đó
                    tdRank.innerHTML = "Trung bình";
                } else {
                    //In ra học lực vào id của ô (td) trong hàng (tr) đó
                    tdRank.innerHTML = "Yếu";
                }

            }
        }

        //Lấy element ID của buton "nhập"
        let InputButton = document.getElementById("input");
        //Gán function + thuộc tính "onclick" button 
        InputButton.onclick = addRow;

        //Lấy element ID của buton "Tính điểm trung bình"
        let AverageButton = document.getElementById("calculate-average");
        //Gán function + thuộc tính "onclick" button 
        AverageButton.onclick = Averange;

        //Lấy element ID của buton "xác định học lực"
        let RankButton = document.getElementById("determine-rank");
        //Gán function + thuộc tính "onclick" button 
        RankButton.onclick = highlightRank;
    </script>

</body>

</html>